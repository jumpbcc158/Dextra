<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Canva Switcher (Lite)</title>
  <style>
    html, body, iframe { height:100%; width:100%; margin:0; border:0; padding:0; background:#fff; }
  </style>
</head>
<body>
  <iframe id="cv" src="https://www.canva.com/design/DAGq31qQuv0/bWCRwDmebc_YtTsuj6VMiA/view?embed#1" allowfullscreen loading="lazy"></iframe>

  <script>
    (function() {
      const MAX = 14;
      const base = "https://www.canva.com/design/DAGq31qQuv0/bWCRwDmebc_YtTsuj6VMiA/view?embed";
      const iframe = document.getElementById('cv');

      function clamp(n) { n = parseInt(n, 10); return (isNaN(n) ? 1 : Math.max(1, Math.min(MAX, n))); }

      function getParamFrom(url, name) {
        try {
          const q = new URL(url).searchParams.get(name);
          return q ? clamp(q) : null;
        } catch (e) { return null; }
      }

      function getHashNumber(hash) {
        if (!hash) return null;
        const m = hash.match(/#(\d+)/);
        return m ? clamp(m[1]) : null;
      }

      function resolvePage() {
        // Priority: local ?page -> parent ?cv -> parent hash -> default 1
        const local = getParamFrom(window.location.href, 'page');
        if (local) return local;

        try {
          // Same-origin only; will fail silently otherwise
          const purl = window.top.location.href;
          const fromCv = getParamFrom(purl, 'cv');
          if (fromCv) return fromCv;
          const fromHash = getHashNumber(window.top.location.hash);
          if (fromHash) return fromHash;
        } catch (e) { /* cross-origin or sandbox */ }

        return 1;
      }

      function setPage(n) {
        iframe.src = base + '#' + clamp(n);
      }

      // Initial set
      setPage(resolvePage());

      // If parent hash changes (e.g., links like #7), try to update without page reload
      try {
        window.top.addEventListener('hashchange', function() {
          const h = getHashNumber(window.top.location.hash);
          if (h) setPage(h);
        });
      } catch (e) { /* ignored if cross-origin */ }
    })();
  </script>
</body>
</html>
